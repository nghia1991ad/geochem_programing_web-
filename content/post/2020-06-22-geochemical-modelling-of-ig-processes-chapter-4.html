---
title: Geochemical modelling of Ig. processes - Chapter 4
author: Nguyen Cong Nghia
date: '2020-06-22'
slug: geochemical-modelling-of-ig-processes-chapter-4
categories:
  - R
tags:
  - Igneous processes
  - geochemical modeling
  - geochemistry
description: ''
featured: ''
featuredalt: ''
featuredpath: ''
linktitle: ''
output:
  blogdown::html_page:
    toc: true
---


<div id="TOC">
<ul>
<li><a href="#log-log-binary-plots">Log-log binary plots</a></li>
<li><a href="#specialized-spider-plots">Specialized spider plots</a></li>
<li><a href="#contour-plots">Contour plots</a></li>
</ul>
</div>

<p>This post is a compilation of the exercises from Chapter 4: Specialized Plots from the book Geochemical Modelling of Igneous Processes - Principles and Recipes in R language by Vojtěch Janoušek, Jean Hervé Martin, Vojtěch Erban and Colin Farrow.</p>
<pre class="r"><code>sink(&quot;/dev/null&quot;); suppressPackageStartupMessages(library(GCDkit)); sink();</code></pre>
<div id="log-log-binary-plots" class="section level3">
<h3>Log-log binary plots</h3>
<pre class="r"><code>data(sazava)
par(mfrow=c(1,2))                       # Split screen for 2 graphs
par(mar=c(4,4,1,1))                     # Outer margins for each of the graphs

# Plot 1
plot(sazava[,&quot;Sr&quot;],sazava[,&quot;Rb&quot;],xlim=c(1,1000),ylim=c(1,1000),xlab=&quot;Sr&quot;,ylab=&quot;Rb&quot;,pch=16,col=&quot;blue&quot;,cex=1.5,xaxs=&quot;i&quot;,yaxs=&quot;i&quot;,log=&quot;&quot;)
invisible(sapply(c(seq(0.1,1,0.1),1:10),function(i)abline(0,i,lty=&quot;dashed&quot;)))

# Plot 2
plot(sazava[,&quot;Sr&quot;],sazava[,&quot;Rb&quot;],xlim=c(1,1000),ylim=c(1,1000),xlab=&quot;Sr&quot;,ylab=&quot;Rb&quot;,pch=16,col=&quot;blue&quot;,cex=1.5,xaxs=&quot;i&quot;,yaxs=&quot;i&quot;,log=&quot;xy&quot;)
invisible(sapply(c(seq(0.1,1,0.1),1:10),function(i)abline(log10(i),1,lty=&quot;dashed&quot;)))</code></pre>
<p><img src="/post/2020-06-22-geochemical-modelling-of-ig-processes-chapter-4_files/figure-html/fig1-1.png" width="960" /></p>
</div>
<div id="specialized-spider-plots" class="section level3">
<h3>Specialized spider plots</h3>
<pre><code>loadData(&quot;dolerites.data&quot;)

# Panel a
ee&lt;-spider.contour(&quot;Boynton&quot;,&quot;MgO&quot;,colour.palette=&quot;terrain.colors&quot;,0.1,100,cex=1.5)

# Panel b
ee&lt;-spider2norm(WR,&quot;Boynton&quot;,&quot;Lu&quot;,0.1,10,pch=1,col=&quot;darkgreen&quot;,cex=1.5)
ee&lt;-spider2norm(WR,&quot;Boynton&quot;,&quot;Lu&quot;,field=TRUE,fill.col=TRUE,shaded.col=&quot;khaki&quot;,add=TRUE)
</code></pre>
<p><img src="/post/2020-06-22-geochemical-modelling-of-ig-processes-chapter-4_files/Screen%20Shot%202020-06-22%20at%204.41.19%20PM.png" />
<img src="/post/2020-06-22-geochemical-modelling-of-ig-processes-chapter-4_files/Screen%20Shot%202020-06-22%20at%204.41.25%20PM.png" /></p>
<pre><code>data(sazava)
accessVar(&quot;sazava&quot;)
groupsByLabel(&quot;Intrusion&quot;)
spider(WR,&quot;Boynton&quot;,1,100,pch=labels$Symbol,col=labels$Colour,cex=2)
figMulti(nrow=1,ncol=3,plot.symb=TRUE)</code></pre>
<p><img src="/post/2020-06-22-geochemical-modelling-of-ig-processes-chapter-4_files/Screen%20Shot%202020-06-22%20at%204.54.59%20PM.png" />
<img src="/post/2020-06-22-geochemical-modelling-of-ig-processes-chapter-4_files/Screen%20Shot%202020-06-22%20at%204.55.26%20PM.png" /></p>
</div>
<div id="contour-plots" class="section level3">
<h3>Contour plots</h3>
<p>This is the code to call the function making contour plots. The GUI will help with further steps.</p>
<pre><code>loadData(&quot;ANDEAN_ARC.csv&quot;)

# Panel a
plotDiagram(&quot;PeceTaylor&quot;,F)
figCol(&quot;aquamarine3&quot;)
addContours()

# Panel b
figRedraw()
filledContourFig()
</code></pre>
<p><img src="/post/2020-06-22-geochemical-modelling-of-ig-processes-chapter-4_files/Screen%20Shot%202020-06-23%20at%203.18.42%20PM.png" />
<img src="/post/2020-06-22-geochemical-modelling-of-ig-processes-chapter-4_files/Screen%20Shot%202020-06-23%20at%203.23.42%20PM.png" /></p>
</div>
