y <- sqrt(3)*b/b
plot(x,y,xlab="",ylab="",xlim=c(0,1),
ylim=c(0,1),axes=FALSE,asp=1)
x
y
plot(x,y)
tri <- function(data,alab, blab, clab){
sums <- apply(data[,c(alab,blab,clab)],1,sum)
a <- data[,alab]/sums
b <- data[,blab]/sums
x <- 1 - a - b/2
y <- sqrt(3)*b/2
plot(x,y,xlab="",ylab="",xlim=c(0,1),
ylim=c(0,1),axes=FALSE,asp=1)
x1 <- c(0,1,.5,0)
y1 <- c(0,0,sqrt(3)/2,0)
lines(x1,y1)
text(-0.05,0,alab)
text(1.05,0,clab)
text(0.5,sqrt(3)/2+0.05,blab)
}
data(sazava)
tri(sazava,"Ba","Rb","Sr")
tri <- function(data,alab, blab, clab){
sums <- apply(data[,c(alab,blab,clab)],1,sum)
a <- data[,alab]/sums
b <- data[,blab]/sums
x <- 1 - a - b/2
y <- sqrt(3)*b/2
plot(x,y,xlab="",ylab="",xlim=c(0,1),
ylim=c(0,1),axes=FALSE,asp=1)
x1 <- c(0,1,.5,0)
y1 <- c(0,0,sqrt(3)/2,0)
lines(x1,y1)
text(-0.05,0,alab)
text(1.05,0,clab)
text(0.5,sqrt(3)/2+0.05,blab)
}
data(sazava)
tri(sazava,"Ba","Rb","Sr")
tri <- function(data,alab, blab, clab){
sums <- apply(data[,c(alab,blab,clab)],1,sum)
a <- data[,alab]/sums
b <- data[,blab]/sums
x <- 1 - a - b/2
y <- sqrt(3)*b/2
plot(x,y,xlab="",ylab="",xlim=c(0,1),
ylim=c(0,1),axes=FALSE,asp=1)
x1 <- c(0,1,.5,0)
y1 <- c(0,0,sqrt(3)/2,0)
lines(x1,y1)
text(-0.05,0,alab)
text(1.05,0,clab)
text(0.5,sqrt(3)/2+0.05,blab)
}
data(sazava)
tri(sazava,"Ba","Rb","Sr")
tri <- function(data,alab, blab, clab){
sums <- apply(data[,c(alab,blab,clab)],1,sum)
a <- data[,alab]/sums
b <- data[,blab]/sums
x <- 1 - a - b/2
y <- sqrt(3)*b/2
plot(x,y,xlab="",ylab="",xlim=c(0,1),
ylim=c(0,1),axes=FALSE,asp=1)
x1 <- c(0,1,.5,0)
y1 <- c(0,0,sqrt(3)/2,0)
lines(x1,y1)
text(-0.05,0,alab)
text(1.05,0,clab)
text(0.5,sqrt(3)/2+0.05,blab)
}
data(sazava)
tri(sazava,"Ba","Rb","Sr")
tri(sazava,"Ba","Rb","Sr")
WR
ternary("Ba","Rb","Sr",pch=1)
plotDiagram("LarochePlut",FALSE)
classify("LarochePlut")
WR
data(sazava)
accessVar("sazava")
data(sazava)
#accessVar("sazava")
WR <- sazava
plotWithLimits(WR[,"SiO2"],WR[,"CaO"],cex=1.2)
WR
x <- read.table("../Data/boynton.data",sep=",")
x <- read.table("/Users/nghianc/R_learn/Modeling_book/Janousek_et_al_2015_modelling_Springer/Part_1/Code/Data/boynton.data",sep=",")
chondrite <- as.numeric(x) # conversion to numeric vector
names(chondrite) <- names(x)
norm <- function(x,chon){
z <- t(x[,names(chon)])/chon
return(z)
}
data(sazava)
y <- norm(sazava,chondrite)
plot(y[,"Po-1"],type="o",log="y",axes=FALSE,xlab="",ylab="REE/chondrite",ylim=c(0.1,100),col="darkgreen")
axis(1,1:length(chondrite),labels=names(chondrite),cex.axis=0.75)
axis(2,cex.axis=0.75)
points(y[,"Po-4"],col="blue")
lines(y[,"Po-4"],col="blue")
abline(h=(10^(-1:3)),lty="dashed")
box()
x <- read.table("../Data/boynton.data",sep=",")
x <- read.table("data/boynton.data",sep=",")
chondrite <- as.numeric(x) # conversion to numeric vector
names(chondrite) <- names(x)
norm <- function(x,chon){
z <- t(x[,names(chon)])/chon
return(z)
}
data(sazava)
y <- norm(sazava,chondrite)
plot(y[,"Po-1"],type="o",log="y",axes=FALSE,xlab="",ylab="REE/chondrite",ylim=c(0.1,100),col="darkgreen")
axis(1,1:length(chondrite),labels=names(chondrite),cex.axis=0.75)
axis(2,cex.axis=0.75)
points(y[,"Po-4"],col="blue")
lines(y[,"Po-4"],col="blue")
abline(h=(10^(-1:3)),lty="dashed")
box()
loadData("sazava.data")
loadData("data/sazava.data")
spider(WR,"Boynton",0.1,1000,pch=labels$Symbol,col=labels$Colour)
spider(WR,"Boynton",field=TRUE,density=0.02,angle=45, col="gray",fill.col=FALSE,add=TRUE)
labels
WR
#loadData("data/sazava.data")
data(sazava)
accessVar("sazava")
spider(WR,"Boynton",0.1,1000,pch=labels$Symbol,col=labels$Colour)
x
blogdown:::insert_image_addin()
blogdown::serve_site()
blogdown:::insert_image_addin()
blogdown::stop_server()
#sazava <- read.table("sazava.data",sep="\t")
data(sazava)
windows(width=10,height=5,pointsize=14) # Empty window of correct size
par(mfrow=c(1,2))                       # Split screen for 2 graphs
par(mar=c(4,4,1,1))                     # Outer margins for each of the graphs
# Plot 1
plot(sazava[,"Sr"],sazava[,"Rb"],xlim=c(1,1000),ylim=c(1,1000),xlab="Sr",ylab="Rb",pch=16,col="blue",cex=1.5,xaxs="i",yaxs="i",log="")
sapply(c(seq(0.1,1,0.1),1:10),function(i)abline(0,i,lty="dashed"))
# Plot 2
plot(sazava[,"Sr"],sazava[,"Rb"],xlim=c(1,1000),ylim=c(1,1000),xlab="Sr",ylab="Rb",pch=16,col="blue",cex=1.5,xaxs="i",yaxs="i",log="xy")
sapply(c(seq(0.1,1,0.1),1:10),function(i)abline(log10(i),1,lty="dashed"))
#sazava <- read.table("sazava.data",sep="\t")
data(sazava)
x11(width=10,height=5,pointsize=14) # Empty window of correct size
par(mfrow=c(1,2))                       # Split screen for 2 graphs
par(mar=c(4,4,1,1))                     # Outer margins for each of the graphs
# Plot 1
plot(sazava[,"Sr"],sazava[,"Rb"],xlim=c(1,1000),ylim=c(1,1000),xlab="Sr",ylab="Rb",pch=16,col="blue",cex=1.5,xaxs="i",yaxs="i",log="")
sapply(c(seq(0.1,1,0.1),1:10),function(i)abline(0,i,lty="dashed"))
# Plot 2
plot(sazava[,"Sr"],sazava[,"Rb"],xlim=c(1,1000),ylim=c(1,1000),xlab="Sr",ylab="Rb",pch=16,col="blue",cex=1.5,xaxs="i",yaxs="i",log="xy")
sapply(c(seq(0.1,1,0.1),1:10),function(i)abline(log10(i),1,lty="dashed"))
blogdown:::new_post_addin()
data(sazava)
par(mfrow=c(1,2))                       # Split screen for 2 graphs
par(mar=c(4,4,1,1))                     # Outer margins for each of the graphs
# Plot 1
plot(sazava[,"Sr"],sazava[,"Rb"],xlim=c(1,1000),ylim=c(1,1000),xlab="Sr",ylab="Rb",pch=16,col="blue",cex=1.5,xaxs="i",yaxs="i",log="")
sapply(c(seq(0.1,1,0.1),1:10),function(i)abline(0,i,lty="dashed"))
# Plot 2
plot(sazava[,"Sr"],sazava[,"Rb"],xlim=c(1,1000),ylim=c(1,1000),xlab="Sr",ylab="Rb",pch=16,col="blue",cex=1.5,xaxs="i",yaxs="i",log="xy")
sapply(c(seq(0.1,1,0.1),1:10),function(i)abline(log10(i),1,lty="dashed"))
data(sazava)
par(mfrow=c(1,2))                       # Split screen for 2 graphs
par(mar=c(4,4,1,1))                     # Outer margins for each of the graphs
# Plot 1
plot(sazava[,"Sr"],sazava[,"Rb"],xlim=c(1,1000),ylim=c(1,1000),xlab="Sr",ylab="Rb",pch=16,col="blue",cex=1.5,xaxs="i",yaxs="i",log="")
sapply(c(seq(0.1,1,0.1),1:10),function(i)abline(0,i,lty="dashed"))
# Plot 2
plot(sazava[,"Sr"],sazava[,"Rb"],xlim=c(1,1000),ylim=c(1,1000),xlab="Sr",ylab="Rb",pch=16,col="blue",cex=1.5,xaxs="i",yaxs="i",log="xy")
sapply(c(seq(0.1,1,0.1),1:10),function(i)abline(log10(i),1,lty="dashed"))
blogdown:::serve_site()
blogdown:::serve_site()
data(sazava)
par(mfrow=c(1,2))                       # Split screen for 2 graphs
par(mar=c(4,4,1,1))                     # Outer margins for each of the graphs
# Plot 1
plot(sazava[,"Sr"],sazava[,"Rb"],xlim=c(1,1000),ylim=c(1,1000),xlab="Sr",ylab="Rb",pch=16,col="blue",cex=1.5,xaxs="i",yaxs="i",log="")
apply(c(seq(0.1,1,0.1),1:10),function(i)abline(0,i,lty="dashed"))
data(sazava)
par(mfrow=c(1,2))                       # Split screen for 2 graphs
par(mar=c(4,4,1,1))                     # Outer margins for each of the graphs
# Plot 1
plot(sazava[,"Sr"],sazava[,"Rb"],xlim=c(1,1000),ylim=c(1,1000),xlab="Sr",ylab="Rb",pch=16,col="blue",cex=1.5,xaxs="i",yaxs="i",log="")
sapply(c(seq(0.1,1,0.1),1:10),function(i)abline(0,i,lty="dashed"))
# Plot 2
plot(sazava[,"Sr"],sazava[,"Rb"],xlim=c(1,1000),ylim=c(1,1000),xlab="Sr",ylab="Rb",pch=16,col="blue",cex=1.5,xaxs="i",yaxs="i",log="xy")
sapply(c(seq(0.1,1,0.1),1:10),function(i)abline(log10(i),1,lty="dashed"))
data(sazava)
par(mfrow=c(1,2))                       # Split screen for 2 graphs
par(mar=c(4,4,1,1))                     # Outer margins for each of the graphs
# Plot 1
plot(sazava[,"Sr"],sazava[,"Rb"],xlim=c(1,1000),ylim=c(1,1000),xlab="Sr",ylab="Rb",pch=16,col="blue",cex=1.5,xaxs="i",yaxs="i",log="")
invisible(sapply(c(seq(0.1,1,0.1),1:10),function(i)abline(0,i,lty="dashed")))
# Plot 2
plot(sazava[,"Sr"],sazava[,"Rb"],xlim=c(1,1000),ylim=c(1,1000),xlab="Sr",ylab="Rb",pch=16,col="blue",cex=1.5,xaxs="i",yaxs="i",log="xy")
invisible(sapply(c(seq(0.1,1,0.1),1:10),function(i)abline(log10(i),1,lty="dashed")))
blogdown::stop_server()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown:::insert_image_addin()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown:::new_post_addin()
blogdown:::update_meta_addin()
blogdown:::new_post_addin()
blogdown::stop_server()
blogdown::serve_site()
blogdown::stop_server()
blogdown:::insert_image_addin()
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=T)
izo
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=T)
izo
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$rb87_sr86 <- 2.6939 +0.2832*izo$`87Sr/86Sr`
izo
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$rb87_sr86 = 2.6939 + 0.2832*izo$`87Sr/86Sr`
izo$Sm147_Nd144 = 0.53151 + 0.14252*izo$`143Nd/144Nd`
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$rb87_sr86 = 2.6939 + 0.2832*izo$`87Sr/86Sr`
izo$Sm147_Nd144 = 0.53151 + 0.14252*izo$`143Nd/144Nd`
izo
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$"87Rb/86Sr" = 2.6939 + 0.2832*izo$`87Sr/86Sr`
izo$"147Sm/144Nd" = 0.53151 + 0.14252*izo$`143Nd/144Nd`
izo
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$"87Rb/86Sr" = 2.6939 + 0.2832*izo$`87Sr/86Sr`
izo$"147Sm/144Nd" = 0.53151 + 0.14252*izo$`143Nd/144Nd`
print(izo[,c("87Rb/86Sr","147Sm/144Nd")]
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$"87Rb/86Sr" = 2.6939 + 0.2832*izo$`87Sr/86Sr`
izo$"147Sm/144Nd" = 0.53151 + 0.14252*izo$`143Nd/144Nd`
print(izo[,c("87Rb/86Sr","147Sm/144Nd")])
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$"87Rb/86Sr" = 2.6939 + 0.2832*izo$`87Sr/86Sr`
izo$"147Sm/144Nd" = 0.53151 + 0.14252*izo$`143Nd/144Nd`
izo
initialSr <- function(data,system="Sr",age){
if (system = "Sr"){
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$"87Rb/86Sr" = 2.6939 + 0.2832*izo$`87Sr/86Sr`
izo$"147Sm/144Nd" = 0.53151 + 0.14252*izo$`143Nd/144Nd`
izo
initial <- function(data,system="Sr",age){
if (system = "Sr"){
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$"87Rb/86Sr" = 2.6939 + 0.2832*izo$`87Sr/86Sr`
izo$"147Sm/144Nd" = 0.53151 + 0.14252*izo$`143Nd/144Nd`
izo
initial <- function(data, age, system="Sr"){
if (system = "Sr"){
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$"87Rb/86Sr" = 2.6939 + 0.2832*izo$`87Sr/86Sr`
izo$"147Sm/144Nd" = 0.53151 + 0.14252*izo$`143Nd/144Nd`
izo
initial <- function(data, system="Sr",age){
if (system = "Sr"){
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$"87Rb/86Sr" = 2.6939 + 0.2832*izo$`87Sr/86Sr`
izo$"147Sm/144Nd" = 0.53151 + 0.14252*izo$`143Nd/144Nd`
izo
initial <- function(data, system="Sr",age){
if (system == "Sr"){
lambda = 1.3968e-11
I = data[,"87Sr/86Sr"]
R = data[,"87Rb/86Sr"]
} else if (system == "Nd"){
lambda = 6.54e-12
I = data[,"143Nd/144Nd"]
R = data[,"147Sm/144Nd"]
}
Ii = I - R * (exp(lambda*age)-1)
return(Ii)
}
izo$"87Sr/86Sr_i" = initial(izo,system="Sr", age= 350)
print(izo$"87Sr/86Sr_i")
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$"87Rb/86Sr" = 2.6939 + 0.2832*izo$`87Sr/86Sr`
izo$"147Sm/144Nd" = 0.53151 + 0.14252*izo$`143Nd/144Nd`
izo
initial <- function(data, system="Sr",age){
if (system == "Sr"){
lambda = 1.3968e-11
I = data[,"87Sr/86Sr"]
R = data[,"87Rb/86Sr"]
} else if (system == "Nd"){
lambda = 6.54e-12
I = data[,"143Nd/144Nd"]
R = data[,"147Sm/144Nd"]
}
Ii = I - R * (exp(lambda*age)-1)
return(Ii)
}
izo$"87Sr/86Sr_i300" = initial(izo,system="Sr", age= 300)
izo$"87Sr/86Sr_i350" = initial(izo,system="Sr", age= 350)
izo$"143Nd/144Nd_i300" = initial(izo,system="Nd", age= 300)
izo$"143Nd/144Nd_i350" = initial(izo,system="Nd", age= 350)
izo
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$"87Rb/86Sr" = 2.6939 + 0.2832*izo$`87Sr/86Sr`
izo$"147Sm/144Nd" = 0.53151 + 0.14252*izo$`143Nd/144Nd`
izo
initial <- function(data, system="Sr",age){
if (system == "Sr"){
lambda = 1.3968e-11
I = data[,"87Sr/86Sr"]
R = data[,"87Rb/86Sr"]
} else if (system == "Nd"){
lambda = 6.54e-12
I = data[,"143Nd/144Nd"]
R = data[,"147Sm/144Nd"]
}
Ii = I - R * (exp(lambda*age*10^6)-1)
return(Ii)
}
izo$"87Sr/86Sr_i300" = initial(izo,system="Sr", age= 300)
izo$"87Sr/86Sr_i350" = initial(izo,system="Sr", age= 350)
izo$"143Nd/144Nd_i300" = initial(izo,system="Nd", age= 300)
izo$"143Nd/144Nd_i350" = initial(izo,system="Nd", age= 350)
izo
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$"87Rb/86Sr" = 2.6939 + 0.2832*izo$`87Sr/86Sr`
izo$"147Sm/144Nd" = 0.53151 + 0.14252*izo$`143Nd/144Nd`
izo
initial <- function(data, system="Sr",age){
if (system == "Sr"){
lambda = 1.3968e-11
I = data[,"87Sr/86Sr"]
R = data[,"87Rb/86Sr"]
} else if (system == "Nd"){
lambda = 6.54e-12
I = data[,"143Nd/144Nd"]
R = data[,"147Sm/144Nd"]
}
Ii = I - R * (exp(lambda*age*10^6)-1)
return(Ii)
}
izo$"87Sr/86Sr_i300" = initial(izo,system="Sr", age= 300)
izo$"87Sr/86Sr_i350" = initial(izo,system="Sr", age= 350)
izo$"143Nd/144Nd_i300" = initial(izo,system="Nd", age= 300)
izo$"143Nd/144Nd_i350" = initial(izo,system="Nd", age= 350)
izo[,c("87Sr/86Sr_i300","87Sr/86Sr_i350","143Nd/144Nd_i300","143Nd/144Nd_i350")]
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$"87Rb/86Sr" = 2.6939 + 0.2832*izo$`87Sr/86Sr`
izo$"147Sm/144Nd" = 0.53151 + 0.14252*izo$`143Nd/144Nd`
izo
initial <- function(data, system="Sr",age){
if (system == "Sr"){
lambda = 1.42e-11
I = data[,"87Sr/86Sr"]
R = data[,"87Rb/86Sr"]
} else if (system == "Nd"){
lambda = 6.54e-12
I = data[,"143Nd/144Nd"]
R = data[,"147Sm/144Nd"]
}
Ii = I - R * (exp(lambda*age*10^6)-1)
return(Ii)
}
izo$"87Sr/86Sr_i300" = initial(izo,system="Sr", age= 300)
izo$"87Sr/86Sr_i350" = initial(izo,system="Sr", age= 350)
izo$"143Nd/144Nd_i300" = initial(izo,system="Nd", age= 300)
izo$"143Nd/144Nd_i350" = initial(izo,system="Nd", age= 350)
izo[,c("87Sr/86Sr_i300","87Sr/86Sr_i350","143Nd/144Nd_i300","143Nd/144Nd_i350")]
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$"87Rb/86Sr" = izo$Rb/izo$Sr*2.6939 + 0.2832*izo$`87Sr/86Sr`
izo$"147Sm/144Nd" = izo$Sm/izo$Nd*0.53151 + 0.14252*izo$`143Nd/144Nd`
izo
initial <- function(data, system="Sr",age){
if (system == "Sr"){
lambda = 1.42e-11
I = data[,"87Sr/86Sr"]
R = data[,"87Rb/86Sr"]
} else if (system == "Nd"){
lambda = 6.54e-12
I = data[,"143Nd/144Nd"]
R = data[,"147Sm/144Nd"]
}
Ii = I - R * (exp(lambda*age*10^6)-1)
return(Ii)
}
izo$"87Sr/86Sr_i300" = initial(izo,system="Sr", age= 300)
izo$"87Sr/86Sr_i350" = initial(izo,system="Sr", age= 350)
izo$"143Nd/144Nd_i300" = initial(izo,system="Nd", age= 300)
izo$"143Nd/144Nd_i350" = initial(izo,system="Nd", age= 350)
izo[,c("87Sr/86Sr_i300","87Sr/86Sr_i350","143Nd/144Nd_i300","143Nd/144Nd_i350")]
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$"87Rb/86Sr" = izo$Rb/izo$Sr*(2.6939 + 0.2832*izo$`87Sr/86Sr`)
izo$"147Sm/144Nd" = izo$Sm/izo$Nd*(0.53151 + 0.14252*izo$`143Nd/144Nd`)
izo
initial <- function(data, system="Sr",age){
if (system == "Sr"){
lambda = 1.42e-11
I = data[,"87Sr/86Sr"]
R = data[,"87Rb/86Sr"]
} else if (system == "Nd"){
lambda = 6.54e-12
I = data[,"143Nd/144Nd"]
R = data[,"147Sm/144Nd"]
}
Ii = I - R * (exp(lambda*age*10^6)-1)
return(Ii)
}
izo$"87Sr/86Sr_i300" = initial(izo,system="Sr", age= 300)
izo$"87Sr/86Sr_i350" = initial(izo,system="Sr", age= 350)
izo$"143Nd/144Nd_i300" = initial(izo,system="Nd", age= 300)
izo$"143Nd/144Nd_i350" = initial(izo,system="Nd", age= 350)
izo[,c("87Sr/86Sr_i300","87Sr/86Sr_i350","143Nd/144Nd_i300","143Nd/144Nd_i350")]
# Part a
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$"87Rb/86Sr" = izo$Rb/izo$Sr*(2.6939 + 0.2832*izo$`87Sr/86Sr`)
izo$"147Sm/144Nd" = izo$Sm/izo$Nd*(0.53151 + 0.14252*izo$`143Nd/144Nd`)
izo
#Part b
initial <- function(data, system="Sr",age){
if (system == "Sr"){
lambda = 1.42e-11
I = data[,"87Sr/86Sr"]
R = data[,"87Rb/86Sr"]
} else if (system == "Nd"){
lambda = 6.54e-12
I = data[,"143Nd/144Nd"]
R = data[,"147Sm/144Nd"]
}
Ii = I - R * (exp(lambda*age*10^6)-1)
return(Ii)
}
izo$"87Sr/86Sr_i300" = initial(izo,system="Sr", age= 300)
izo$"87Sr/86Sr_i350" = initial(izo,system="Sr", age= 350)
izo$"143Nd/144Nd_i300" = initial(izo,system="Nd", age= 300)
izo$"143Nd/144Nd_i350" = initial(izo,system="Nd", age= 350)
izo[,c("87Sr/86Sr_i300","87Sr/86Sr_i350","143Nd/144Nd_i300","143Nd/144Nd_i350")]
#Part c
ini87Sr_86Sr = 0.705
age_Koz2 = 1/lambda*log((izo["Koz-2","87Sr/86Sr"]-ini87Sr_86Sr)/izo["Koz-2","87Rb/86Sr"]+1)/10^6
# Part a
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$"87Rb/86Sr" = izo$Rb/izo$Sr*(2.6939 + 0.2832*izo$`87Sr/86Sr`)
izo$"147Sm/144Nd" = izo$Sm/izo$Nd*(0.53151 + 0.14252*izo$`143Nd/144Nd`)
izo
#Part b
initial <- function(data, system="Sr",age){
if (system == "Sr"){
lambda = 1.42e-11
I = data[,"87Sr/86Sr"]
R = data[,"87Rb/86Sr"]
} else if (system == "Nd"){
lambda = 6.54e-12
I = data[,"143Nd/144Nd"]
R = data[,"147Sm/144Nd"]
}
Ii = I - R * (exp(lambda*age*10^6)-1)
return(Ii)
}
izo$"87Sr/86Sr_i300" = initial(izo,system="Sr", age= 300)
izo$"87Sr/86Sr_i350" = initial(izo,system="Sr", age= 350)
izo$"143Nd/144Nd_i300" = initial(izo,system="Nd", age= 300)
izo$"143Nd/144Nd_i350" = initial(izo,system="Nd", age= 350)
izo[,c("87Sr/86Sr_i300","87Sr/86Sr_i350","143Nd/144Nd_i300","143Nd/144Nd_i350")]
#Part c
ini87Sr_86Sr = 0.705
lambda = 1.42e-11
age_Koz2 = 1/lambda*log((izo["Koz-2","87Sr/86Sr"]-ini87Sr_86Sr)/izo["Koz-2","87Rb/86Sr"]+1)/10^6
age_Koz2
# Part a
izo <- read.table("data/cbpizo.data", sep= "\t", check.names=F)
izo$"87Rb/86Sr" = izo$Rb/izo$Sr*(2.6939 + 0.2832*izo$`87Sr/86Sr`)
izo$"147Sm/144Nd" = izo$Sm/izo$Nd*(0.53151 + 0.14252*izo$`143Nd/144Nd`)
izo
#Part b
initial <- function(data, system="Sr",age){
if (system == "Sr"){
lambda = 1.42e-11
I = data[,"87Sr/86Sr"]
R = data[,"87Rb/86Sr"]
} else if (system == "Nd"){
lambda = 6.54e-12
I = data[,"143Nd/144Nd"]
R = data[,"147Sm/144Nd"]
}
Ii = I - R * (exp(lambda*age*10^6)-1)
return(Ii)
}
izo$"87Sr/86Sr_i300" = initial(izo,system="Sr", age= 300)
izo$"87Sr/86Sr_i350" = initial(izo,system="Sr", age= 350)
izo$"143Nd/144Nd_i300" = initial(izo,system="Nd", age= 300)
izo$"143Nd/144Nd_i350" = initial(izo,system="Nd", age= 350)
izo[,c("87Sr/86Sr_i300","87Sr/86Sr_i350","143Nd/144Nd_i300","143Nd/144Nd_i350")]
#Part c
ini87Sr_86Sr = 0.705
lambda = 1.42e-11
age_Koz2 = 1/lambda*log((izo["Koz-2","87Sr/86Sr"]-ini87Sr_86Sr)/izo["Koz-2","87Rb/86Sr"] + 1)
age_Koz2/10^6
blogdown::serve_site()
